{"version":3,"sources":["fluid-config.js","KeynoteRow.jsx","Table.jsx","KeynotesModel.js","index.jsx"],"names":["containerSchema","initialObjects","myMap","SharedMap","connectionConfig","uuid","getRandomName","connection","tenantId","tokenProvider","InsecureTokenProvider","id","orderer","storage","KeynoteRow","props","TextField","class","onChange","e","setText","currentTarget","value","text","placeholder","Table","fluidContainer","container","React","useState","sharedMap","SetNoteText","noteId","noteText","set","Array","from","keys","length","CreateNote","get","NoteIds","setChangeListener","listener","on","createKeynotesModel","model","notes","setNotes","useEffect","syncLocalAndFluidState","noteDataArr","ids","newNoteData","push","map","note","i","start","a","getContainerId","isNew","window","location","hash","containerId","substring","client","AzureClient","createContainer","services","attach","getContainer","console","log","connected","Promise","resolve","once","ReactDOM","render","document","getElementById","catch","error"],"mappings":"iUAMaA,EAAkB,CAC3BC,eAAgB,CAAEC,MAAOC,MAShBC,GALLC,cACEC,cAKR,CACEC,WAAY,CACRC,SAAU,uCACVC,cAAe,IAAIC,wBAAsB,mCAAoC,CAAEC,GAAI,WACnFC,QAAS,8CACTC,QAAS,oD,+BClBV,SAASC,EAAWC,GACvB,OACI,+BACI,6BAAKA,EAAMJ,KACX,6BACI,cAACK,EAAA,EAAD,CAAWC,MAAM,aACbC,SAAU,SAACC,GAAD,OAAOJ,EAAMK,QAAQD,EAAEE,cAAcC,QAC/CA,MAASP,EAAMQ,KACfC,YAAa,yBCR1B,SAASC,EAAMV,GAElB,IAAMW,EAAiBX,EAAMY,UAC7B,EAAkBC,IAAMC,SCLrB,SAA6BH,GAEhC,IAAMI,EAAYJ,EAAezB,eAAeC,MAE1C6B,EAAc,SAACC,EAAQC,GACzBH,EAAUI,IAAIF,EAAQC,IAW1B,OAP2C,IAAxCE,MAAMC,KAAKN,EAAUO,QAAQC,SAC5BP,EAAY,EAAG,aACfA,EAAY,EAAG,YACfA,EAAY,EAAG,YACfA,EAAY,EAAG,eAGZ,CACHQ,WADG,SACQP,GAKP,MAJgB,CACZrB,GAAIqB,EACJT,KAAMO,EAAUU,IAAIR,KAK5BD,cAEIU,cACA,OACIN,MAAMC,KAAKN,EAAUO,SAG7BK,kBAhBG,SAgBeC,GACdb,EAAUc,GAAG,eAAgBD,KD5BJE,CAAoBnB,IAA7CoB,EAAR,oBACA,EAA4BlB,IAAMC,SAAS,IAA3C,mBAAQkB,EAAR,KAAeC,EAAf,KAGApB,IAAMqB,WAAW,WACb,IAAMC,EAAyB,WAE3B,IAFiC,EAE3BC,EAAc,GACdC,EAAMN,EAAML,QAHe,cAKdW,GALc,IAKjC,2BAAwB,CAAC,IAAhBpB,EAAe,QACdqB,EAAcP,EAAMP,WAAWP,GACrCmB,EAAYG,KAAKD,IAPY,8BASjCL,EAASG,IAGbD,IAEAJ,EAAMJ,kBAAkBQ,KACxB,CAACJ,IAOL,OACI,kCACI,gCACI,+BACI,qCACA,2CAGR,gCACKC,EAAMQ,KAAI,SAACC,EAAMC,GAId,OACI,cAAC3C,EAAD,CAEIH,GAAI6C,EAAK7C,GACTY,KAAQiC,EAAKjC,KACbH,QARQ,SAACG,IAfb,SAACZ,EAAIY,GAErBuB,EAAMf,YAAYpB,EAAIY,GAcNQ,CAAYyB,EAAK7C,GAAIY,KAIZiC,EAAK7C,YExC/B,SAAe+C,IAAtB,+B,4CAAO,8CAAAC,EAAA,yDAEGC,EAAiB,WACnB,IAAIC,GAAQ,EAKZ,OAJoC,IAAhCC,OAAOC,SAASC,KAAK1B,SACrBuB,GAAQ,GAGL,CAAEI,YADWH,OAAOC,SAASC,KAAKE,UAAU,GAC7BL,UARvB,EAW4BD,IAAvBK,EAXL,EAWKA,YAAaJ,EAXlB,EAWkBA,MAEfM,EAAS,IAAIC,IAAYhE,IAI3ByD,EAjBD,iCAkBkCM,EAAOE,gBAAgBrE,GAlBzD,uBAkBI2B,EAlBJ,EAkBIA,UAAW2C,EAlBf,EAkBeA,SAlBf,UAmB2B3C,EAAU4C,SAnBrC,QAmBON,EAnBP,OAoBCH,OAAOC,SAASC,KAAOC,EApBxB,yCAsBkCE,EAAOK,aAAaP,EAAajE,GAtBnE,iBAsBI2B,EAtBJ,EAsBIA,UAAW2C,EAtBf,EAsBeA,SAtBf,WAwBCA,GAAUG,QAAQC,IAAI,oBAErB/C,EAAUgD,UA1BZ,kCA2BO,IAAIC,SAAQ,SAACC,GACflD,EAAUmD,KAAK,aAAa,WACxBD,UA7BT,QAkCHE,IAASC,OACL,8BACI,cAACvD,EAAD,CAAOE,UAAWA,MAEtBsD,SAASC,eAAe,SAtCzB,6C,sBA0CPxB,IAAQyB,OAAM,SAACC,GAAD,OAAWX,QAAQW,MAAMA,Q","file":"static/js/main.b8d9c962.chunk.js","sourcesContent":["import { /*AzureClientProps, AzureFunctionTokenProvider,*/ LOCAL_MODE_TENANT_ID } from \"@fluidframework/azure-client\";\r\nimport { SharedMap } from \"fluid-framework\";\r\nimport { getRandomName } from \"@fluidframework/server-services-client\";\r\nimport { v4 as uuid } from 'uuid';\r\nimport { InsecureTokenProvider } from \"@fluidframework/test-client-utils\";\r\n\r\nexport const containerSchema = {\r\n    initialObjects: { myMap: SharedMap }\r\n  };\r\n\r\nexport const userConfig = {\r\n    id: uuid(),\r\n    name: getRandomName(),\r\n};\r\n\r\n\r\nexport const connectionConfig =\r\n  { \r\n    connection: {\r\n        tenantId: \"b801a86a-3a95-4a4c-883d-edb778658a74\",\r\n        tokenProvider: new InsecureTokenProvider(\"d3a190af6ef61f8f847a7ae40b12d3f4\", { id: \"userId\" }),\r\n        orderer: \"https://alfred.westus2.fluidrelay.azure.com\",\r\n        storage: \"https://historian.westus2.fluidrelay.azure.com\",\r\n    }\r\n}\r\n// { \r\n//     connection: {\r\n//         tenantId: LOCAL_MODE_TENANT_ID,\r\n//         tokenProvider: new InsecureTokenProvider(\"fooBar\", userConfig),\r\n//         orderer: \"http://localhost:7070\",\r\n//         storage: \"http://localhost:7070\",\r\n//     }\r\n// };\r\n","import React from \"react\";\r\nimport { TextField } from \"@fluentui/react\";\r\nimport './App.css'\r\n\r\nexport function KeynoteRow(props) {\r\n    return (\r\n        <tr>\r\n            <td>{props.id}</td>\r\n            <td>\r\n                <TextField class=\"text-field\"\r\n                    onChange={(e) => props.setText(e.currentTarget.value)}\r\n                    value = {props.text}\r\n                    placeholder={\"Enter Text Here\"}\r\n                />\r\n            </td>\r\n        </tr>\r\n    );\r\n}","import React from \"react\";\r\nimport {KeynoteRow} from \"./KeynoteRow.jsx\";\r\nimport {createKeynotesModel} from \"./KeynotesModel.js\"\r\nimport \"./App.css\"\r\nexport function Table(props) {\r\n\r\n    const fluidContainer = props.container;\r\n    const [ model ] = React.useState(createKeynotesModel(fluidContainer));\r\n    const [ notes, setNotes ] = React.useState([]);\r\n\r\n    // runs when model changes\r\n    React.useEffect( () => {\r\n        const syncLocalAndFluidState = () => {\r\n            // construct note array\r\n            const noteDataArr = [];\r\n            const ids = model.NoteIds;\r\n            // recreate the list of keynotes to re-render them via setNotes\r\n            for (let noteId of ids) {\r\n                const newNoteData = model.CreateNote(noteId);\r\n                noteDataArr.push(newNoteData);\r\n            }\r\n            setNotes(noteDataArr);\r\n        }\r\n        // immediately sync model and ui state\r\n        syncLocalAndFluidState();\r\n        // The listener will call syncLocalAndFluidState everytime there a \"valueChanged\" event\r\n        model.setChangeListener(syncLocalAndFluidState);\r\n     }, [model] );\r\n\r\n    const SetNoteText = (id, text) => {\r\n        //console.log(\"setting keynote \"+ id + \" with text: \" + text);\r\n        model.SetNoteText(id, text);\r\n    }\r\n\r\n    return(\r\n        <table>\r\n            <thead>\r\n                <tr>\r\n                    <td>Key</td>\r\n                    <td>Note</td>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {notes.map((note, i) => {\r\n                    const setText = (text) => {\r\n                        SetNoteText(note.id, text);\r\n                    };\r\n                    return (\r\n                        <KeynoteRow\r\n                            key={note.id}\r\n                            id={note.id}\r\n                            text = {note.text}\r\n                            setText={setText}\r\n                        />\r\n                    )\r\n                })}\r\n            </tbody>\r\n        </table>\r\n    );\r\n}","//import { SharedMap } from \"fluid-framework\";\r\n\r\nexport function createKeynotesModel(fluidContainer) {\r\n    \r\n    const sharedMap = fluidContainer.initialObjects.myMap;\r\n\r\n    const SetNoteText = (noteId, noteText) => {\r\n        sharedMap.set(noteId, noteText);\r\n    }\r\n\r\n        // populate table on first run\r\n    if(Array.from(sharedMap.keys()).length === 0) {\r\n        SetNoteText(0, \"note zero\");\r\n        SetNoteText(1, \"note one\");\r\n        SetNoteText(2, \"note two\");\r\n        SetNoteText(3, \"note three\");\r\n    }\r\n\r\n    return {\r\n        CreateNote(noteId) {\r\n            const newNote = {\r\n                id: noteId,\r\n                text: sharedMap.get(noteId),\r\n            };\r\n            return newNote;\r\n        },\r\n\r\n        SetNoteText,\r\n\r\n        get NoteIds() {\r\n            return (\r\n                Array.from(sharedMap.keys())\r\n            );\r\n        },\r\n        setChangeListener(listener) {\r\n            sharedMap.on(\"valueChanged\", listener);\r\n            //valueChangeEvent = listener;\r\n        },\r\n\r\n        // removeChangeListener(listener) {\r\n        //     sharedMap.off(\"valueChanged\", listener);\r\n        // }\r\n    }\r\n}","import './App.css';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { AzureClient, /*AzureContainerServices */} from '@fluidframework/azure-client';\r\nimport { connectionConfig, containerSchema } from \"./fluid-config\";\r\nimport {Table} from \"./Table.jsx\";\r\n\r\n//const timeKey = \"time-key\";\r\nexport async function start() {\r\n\r\n    const getContainerId = () => {\r\n        let isNew = false;\r\n        if (window.location.hash.length === 0) {\r\n            isNew = true;\r\n        }\r\n        const containerId = window.location.hash.substring(1);\r\n        return { containerId, isNew };\r\n    };\r\n\r\n    const { containerId, isNew } = getContainerId();\r\n\r\n    const client = new AzureClient(connectionConfig);\r\n    let container;\r\n    let services;\r\n\r\n    if (isNew) {\r\n        ({ container, services } = await client.createContainer(containerSchema));\r\n        const containerId = await container.attach();\r\n        window.location.hash = containerId;\r\n    } else {\r\n        ({ container, services } = await client.getContainer(containerId, containerSchema));\r\n    }\r\n    if(!services) console.log(\"missing services\");\r\n\r\n    if (!container.connected) {\r\n        await new Promise((resolve) => {\r\n            container.once(\"connected\", () => {\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    ReactDOM.render(\r\n        <div>\r\n            <Table container={container}/>\r\n        </div>,\r\n        document.getElementById('root')\r\n    )\r\n}\r\n\r\nstart().catch((error) => console.error(error));\r\n"],"sourceRoot":""}